---
globs: *.py
---
### Règle Python: intégration MCP dans les agents/tâches (CrewAI)

- **Toujours ouvrir MCP dans un contexte**: `with MCPServerAdapter(server_params) as mcp_tools:` puis passer `mcp_tools` à votre construction de crew/agents.
- **Passer les tools vivants à l'Agent**: dans `Agent(..., tools=mcp_tools, ...)` ou via une liste filtrée (voir `build_crew`).
- **Ne pas fermer MCP** dans les helpers (`build_crew` ne doit pas gérer la fermeture); gérez la durée de vie au niveau appelant.
- **Arguments de tool**: pour la recherche d'entreprises, privilégier `{"q": "<secteur>", "code_commune": "34172", "per_page": 5}`.
- **Éviter** le champ `commune`; utiliser `code_commune`.

Références internes:
- [mcp_re/src/mcp_re/crew.py](mdc:mcp_re/src/mcp_re/crew.py)
- [mcp_re/src/mcp_re/main.py](mdc:mcp_re/src/mcp_re/main.py)